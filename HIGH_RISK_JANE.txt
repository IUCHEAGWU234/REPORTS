CREATE TABLE RISK_RATE NOLOGGING NOCACHE PARALLEL(DEGREE 100) AS 
select /*+PARALLEL64*/ a.CUST_NO AS CUSTOMER, CUST_AC_NO AS ACC_NO, AC_DESC AS CUSTOMER_NAME, 
CASE WHEN GET_ACCOUNT_sEGMENT_CODE(a.CUST_AC_NO, a.BRANCH_CODE) = 'CM' THEN 'COMMERCIAL'
  WHEN GET_ACCOUNT_sEGMENT_CODE(a.CUST_AC_NO, a.BRANCH_CODE) = 'CS' THEN 'CONSUMER'
    WHEN GET_ACCOUNT_sEGMENT_CODE(a.CUST_AC_NO, a.BRANCH_CODE) = 'CB' THEN 'CORPORATE' ELSE 'UNCODED' END AS SECTOR,
      ACCOUNT_CLASS, b.field_val_7 AS RISK_RATING, GET_CUST_BVN(CUST_NO)BVN, 
      CASE WHEN a.RECORD_STAT = 'O' THEN 'OPENED' ELSE 'CLOSED' END AS STATUS,
        a.AC_OPEN_DATE AS DATE_OF_OPENING
from STTM_CUST_ACCOUNT a LEFT JOIN fcubsnig.cstm_function_userdef_fields b
ON substr(b.rec_key,1,9) = a.cust_no
WHERE b.FUNCTION_ID = 'STDCIF'
AND a.RECORD_STAT = 'O'
ORDER by b.field_val_7 desc;

SELECT * FROM RISK_RATE
------------------------------------------------------------------------------

CREATE TABLE HIGH_RISK NOLOGGING NOCACHE PARALLEL(DEGREE 100) AS 

SELECT * FROM RISK_RATE
WHERE RISK_RATING = 1;

SELECT * FROM HIGH_RISK